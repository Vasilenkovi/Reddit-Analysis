version: '3.8'
services:
  nginx:
    build: ./nginx
    ports:
      - 80:80
    command: ""
    healthcheck:
      test: [ "CMD", "curl", "-fk", "http://localhost:8000" ]
      interval: 5s
      timeout: 6s
      retries: 10
    environment:
      - NGINX_HOST=51.250.112.4
      - NGINX_PORT=80
      - DAPHNE_HOST=backend
      - DAPHNE_PORT=8000
    volumes:
      - ./DjangoRed/static/:/static/
  message-broker:
    image: rabbitmq:3-management
    ports:
      - 5672:5672
      - 15672:15672
  mysqlred:
    build: ./MySQL
    ports:
      - 3309:3306
    command: --lower_case_table_names=1
    volumes:
      - /var/lib/mysql